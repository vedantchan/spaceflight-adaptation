%% 6/10/19 Calculates WPM
% takes in one subject data folder (with all 5 split data)

function [wpm] = keystrokeWPM(subjdatafold,switchtimesheet)
    
    KEYS = importdata(subjdatafold);
    %KEYS = importdata(list(i,:));
    EXkeys = extractBetween(KEYS(2:end), 11, 22);
    EXkeys = datetime(EXkeys, 'inputformat', 'HH:mm:ss.SSS'); 
    TIMES_sec = EXkeys.Hour*3600+EXkeys.Minute*60+EXkeys.Second;

    st = importdata(switchtimesheet);
    switchtimes = rmmissing(st.data); %gets rid of NANs
    subjcol = switchtimes(:,find(contains(st.textdata,['Subj' num2str(subjnum)])));
    
    intervals = diff(TIMES_sec);
    ind = find(intervals > min(subjcol));
    cleanedintervals = intervals;
    cleanedintervals(ind) = [];

    totalmins = sum(cleanedintervals)/60;

    % no backspace, no shift, no enter
    notkeys = find(contains(KEYS,'RShiftKeyÂ') | contains(KEYS,'ReturnÂ') | contains(KEYS,'BackÂ'));
    newkeys = KEYS;
    newkeys(notkeys) = [];
    totalkeys = length(newkeys);
    
    wpm = (totalkeys/5)/totalmins;
    
    wpm_corrected = 
    

    